---
interface Props {
  title: string;
  description: string;
  image?: string;
  url?: string;
  type?: 'website' | 'article';
  publishedAt?: string;
  updatedAt?: string;
  author?: string;
  tags?: string[];
  noindex?: boolean;
  nofollow?: boolean;
}

const {
  title,
  description,
  image,
  url,
  type = 'website',
  publishedAt,
  updatedAt,
  author,
  tags,
  noindex = false,
  nofollow = false,
} = Astro.props;

const siteUrl = import.meta.env.PUBLIC_SITE_URL || 'https://wardayahub.vercel.app';
const siteName = import.meta.env.PUBLIC_SITE_NAME || 'WardayaHub';
const fullUrl = url || Astro.url.href;
const ogImage = image || `${siteUrl}/og-default.jpg`;

// Robots meta content
const robotsContent = [
  noindex ? 'noindex' : 'index',
  nofollow ? 'nofollow' : 'follow',
].join(', ');

// JSON-LD Structured Data
const jsonLd = type === 'article' && publishedAt
  ? {
      '@context': 'https://schema.org',
      '@type': 'Article',
      headline: title,
      description: description,
      image: ogImage,
      datePublished: publishedAt,
      dateModified: updatedAt || publishedAt,
      author: author ? {
        '@type': 'Person',
        name: author,
      } : undefined,
      publisher: {
        '@type': 'Organization',
        name: siteName,
        logo: {
          '@type': 'ImageObject',
          url: `${siteUrl}/logo.png`,
        },
      },
      mainEntityOfPage: {
        '@type': 'WebPage',
        '@id': fullUrl,
      },
    }
  : {
      '@context': 'https://schema.org',
      '@type': 'WebSite',
      name: siteName,
      url: siteUrl,
      description: description,
    };
---

<!-- Primary Meta Tags -->
<title>{title}</title>
<meta name="title" content={title} />
<meta name="description" content={description} />
<meta name="robots" content={robotsContent} />
<meta name="googlebot" content={robotsContent} />

<!-- Canonical URL -->
<link rel="canonical" href={fullUrl} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={fullUrl} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={ogImage} />
<meta property="og:image:alt" content={title} />
<meta property="og:site_name" content={siteName} />
<meta property="og:locale" content="en_US" />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content={fullUrl} />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={ogImage} />
<meta name="twitter:image:alt" content={title} />

<!-- Article specific -->
{
  type === 'article' && (
    <>
      {publishedAt && <meta property="article:published_time" content={publishedAt} />}
      {updatedAt && <meta property="article:modified_time" content={updatedAt} />}
      {author && <meta property="article:author" content={author} />}
      {tags?.map((tag: string) => <meta property="article:tag" content={tag} />)}
      <meta property="article:section" content="Blog" />
    </>
  )
}

<!-- JSON-LD Structured Data -->
<script type="application/ld+json" set:html={JSON.stringify(jsonLd)} is:inline />
