---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/blog/PostCard.astro';
import Newsletter from '../components/common/Newsletter';
import { getPosts } from '../lib/blog';
import type { Post } from '../types';

const siteDescription = import.meta.env.PUBLIC_SITE_DESCRIPTION || 'Headless CMS Blog Platform';

let recentPosts: Post[] = [];
try {
  const result = await getPosts(1, 3);
  recentPosts = result.posts;
} catch (e) {
  console.error('Error loading recent posts:', e);
}
---

<BaseLayout
  seo={{
    title: 'Home - WardayaHub',
    description: siteDescription,
    type: 'website',
  }}
>
  <div class="hero-section">
    <div class="container">
      <div class="hero-content">
        <div class="hero-badge">
          <svg class="badge-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
          </svg>
          <span>Modern Blog Platform</span>
        </div>
        
        <h1 class="hero-title">
          Welcome to <span class="gradient-text">WardayaHub</span>
        </h1>
        
        <p class="hero-description">
          {siteDescription}. Built with Astro for blazing-fast performance and Strapi for seamless content management.
        </p>
        
        <div class="hero-cta">
          <a href="/blog" class="btn btn-primary btn-lg">
            <span>Explore Blog</span>
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14m-7-7l7 7-7 7"/>
            </svg>
          </a>
          <a href="#features" class="btn btn-secondary btn-lg">
            <span>Learn More</span>
          </a>
        </div>

        <div class="hero-stats">
          <div class="stat">
            <div class="stat-value">{recentPosts.length}+</div>
            <div class="stat-label">Articles</div>
          </div>
          <div class="stat-divider"></div>
          <div class="stat">
            <div class="stat-value">Fast</div>
            <div class="stat-label">Performance</div>
          </div>
          <div class="stat-divider"></div>
          <div class="stat">
            <div class="stat-value">SEO</div>
            <div class="stat-label">Optimized</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="hero-gradient"></div>
  </div>

  <section id="features" class="features-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Everything you need for a modern blog</h2>
        <p class="section-description">
          Powerful features designed for developers and content creators
        </p>
      </div>
      
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon" style="background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
            </svg>
          </div>
          <h3 class="feature-title">Lightning Fast</h3>
          <p class="feature-description">
            Built with Astro for blazing-fast static site generation and optimal performance
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon" style="background: linear-gradient(135deg, #10b981 0%, #34d399 100%);">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z"/>
            </svg>
          </div>
          <h3 class="feature-title">Easy Management</h3>
          <p class="feature-description">
            Powered by Strapi headless CMS for intuitive and flexible content editing
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="16 18 22 12 16 6"/>
              <polyline points="8 6 2 12 8 18"/>
            </svg>
          </div>
          <h3 class="feature-title">Modern Stack</h3>
          <p class="feature-description">
            TypeScript, React, and cutting-edge tools for scalable development
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon" style="background: linear-gradient(135deg, #ec4899 0%, #a855f7 100%);">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
          </div>
          <h3 class="feature-title">SEO Ready</h3>
          <p class="feature-description">
            Comprehensive SEO features and Open Graph support out of the box
          </p>
        </div>
      </div>
    </div>
  </section>

  {recentPosts.length > 0 && (
    <section class="posts-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Latest Articles</h2>
          <p class="section-description">
            Discover our most recent blog posts and insights
          </p>
        </div>
        
        <div class="posts-grid">
          {recentPosts.map((post) => (
            <PostCard post={post} />
          ))}
        </div>
        
        <div class="section-cta">
          <a href="/blog" class="btn btn-outline">
            <span>View All Posts</span>
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14m-7-7l7 7-7 7"/>
            </svg>
          </a>
        </div>
      </div>
    </section>
  )}

  <Newsletter client:visible />
</BaseLayout>

<style>
  /* Hero Section */
  .hero-section {
    position: relative;
    padding: var(--spacing-3xl) 0;
    overflow: hidden;
  }

  .hero-gradient {
    position: absolute;
    top: -50%;
    right: -20%;
    width: 80%;
    height: 150%;
    background: var(--gradient-primary);
    opacity: 0.05;
    border-radius: 50%;
    filter: blur(80px);
    pointer-events: none;
    z-index: -1;
  }

  .hero-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    max-width: 800px;
    margin: 0 auto;
    position: relative;
  }

  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-lg);
    background: hsl(var(--color-muted));
    border: 1px solid hsl(var(--color-border));
    border-radius: var(--radius-2xl);
    font-size: var(--text-sm);
    font-weight: 500;
    color: hsl(var(--color-foreground));
    margin-bottom: var(--spacing-xl);
    animation: fadeInUp 0.6s ease-out;
  }

  .badge-icon {
    width: 16px;
    height: 16px;
    color: hsl(var(--color-primary));
  }

  .hero-title {
    font-size: var(--text-5xl);
    font-weight: 800;
    line-height: 1.1;
    margin-bottom: var(--spacing-lg);
    color: hsl(var(--color-foreground));
    animation: fadeInUp 0.6s ease-out 0.1s both;
  }

  .gradient-text {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .hero-description {
    font-size: var(--text-lg);
    line-height: 1.6;
    color: hsl(var(--color-muted-foreground));
    margin-bottom: var(--spacing-2xl);
    max-width: 600px;
    animation: fadeInUp 0.6s ease-out 0.2s both;
  }

  .hero-cta {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-3xl);
    animation: fadeInUp 0.6s ease-out 0.3s both;
  }

  .hero-stats {
    display: flex;
    align-items: center;
    gap: var(--spacing-xl);
    padding: var(--spacing-lg);
    background: hsl(var(--color-card));
    border: 1px solid hsl(var(--color-border));
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-sm);
    animation: fadeInUp 0.6s ease-out 0.4s both;
  }

  .stat {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .stat-value {
    font-size: var(--text-2xl);
    font-weight: 700;
    color: hsl(var(--color-primary));
    line-height: 1;
    margin-bottom: var(--spacing-xs);
  }

  .stat-label {
    font-size: var(--text-xs);
    color: hsl(var(--color-muted-foreground));
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .stat-divider {
    width: 1px;
    height: 32px;
    background: hsl(var(--color-border));
  }

  /* Buttons - Moved to global design-system.css */

  /* Sections */
  .features-section,
  .posts-section {
    padding: var(--spacing-3xl) 0;
  }

  .section-header {
    text-align: center;
    margin-bottom: var(--spacing-3xl);
  }

  .section-title {
    font-size: var(--text-4xl);
    font-weight: 700;
    margin-bottom: var(--spacing-md);
    color: hsl(var(--color-foreground));
  }

  .section-description {
    font-size: var(--text-lg);
    color: hsl(var(--color-muted-foreground));
    max-width: 600px;
    margin: 0 auto;
  }

  /* Features Grid */
  .features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--spacing-xl);
  }

  .feature-card {
    padding: var(--spacing-xl);
    background: hsl(var(--color-card));
    border: 1px solid hsl(var(--color-border));
    border-radius: var(--radius-xl);
    transition: all var(--transition-base);
  }

  .feature-card:hover {
    box-shadow: var(--shadow-lg);
    transform: translateY(-4px);
    border-color: hsl(var(--color-primary) / 0.3);
  }

  .feature-icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: var(--spacing-lg);
  }

  .feature-icon svg {
    width: 24px;
    height: 24px;
    color: white;
  }

  .feature-title {
    font-size: var(--text-xl);
    font-weight: 600;
    margin-bottom: var(--spacing-sm);
    color: hsl(var(--color-foreground));
  }

  .feature-description {
    color: hsl(var(--color-muted-foreground));
    line-height: 1.6;
  }

  /* Posts Grid */
  .posts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-xl);
    margin-bottom: var(--spacing-2xl);
  }

  .section-cta {
    text-align: center;
  }

  /* Animations */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Responsive */
  @media (max-width: 768px) {
    .hero-title {
      font-size: var(--text-3xl);
    }

    .hero-description {
      font-size: var(--text-base);
    }

    .hero-cta {
      flex-direction: column;
      width: 100%;
    }

    .btn {
      width: 100%;
      justify-content: center;
    }

    .hero-stats {
      flex-direction: column;
      gap: var(--spacing-md);
    }

    .stat-divider {
      width: 100%;
      height: 1px;
    }

    .section-title {
      font-size: var(--text-3xl);
    }

    .features-grid,
    .posts-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
